---
import { Picture as AstroPicture } from "astro:assets";
import { renderPDF } from "../lib/render-pdf";

interface Props {
  src: ImageMetadata | `${string}.pdf`;
  alt: string;
  priority?: boolean;
  invertInDarkMode?: boolean;
}

const { src, alt, priority = false, invertInDarkMode = false } = Astro.props;

let image: ImageMetadata;

if (typeof src === "string") {
  image = await renderPDF(src);
} else {
  image = src;
}
---

<AstroPicture
  class={`mx-auto w-min max-h-[calc(100svh-3rem)] max-w-full rounded-2xl ring-1 ring-zinc-300/70 shadow-[0_18px_50px_-28px_rgba(15,95,120,0.65)] dark:ring-zinc-700 ${invertInDarkMode ? "dark:invert" : ""}`}
  src={image}
  alt={alt}
  layout="constrained"
  formats={["avif"]}
  priority={priority}
  fit="contain"
/>
